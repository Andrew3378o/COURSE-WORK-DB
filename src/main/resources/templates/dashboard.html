<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments :: head_styles}"></head>
<body>
<div th:replace="~{fragments :: sidebar('dashboard')}"></div>
<div class="main-content">
    <div class="d-flex justify-content-between align-items-center mb-5">
        <div>
            <h2 class="fw-bold mb-1">Центр моніторингу</h2>
            <p class="text-muted mb-0">Оперативна обстановка станом на <span th:text="${#dates.format(#dates.createNow(), 'dd MMM yyyy')}">Date</span></p>
        </div>
    </div>

    <div class="row g-4 mb-5">
        <div class="col-md-3">
            <a href="/ui/facilities" class="text-decoration-none">
                <div class="card-custom p-4 h-100 d-flex flex-column justify-content-between position-relative">
                    <div class="d-flex justify-content-between align-items-start mb-3">
                        <div class="text-primary fs-3"><i class="bi bi-buildings-fill"></i></div>
                        <span class="badge bg-success bg-opacity-10 text-success rounded-pill">Активно</span>
                    </div>
                    <div><h2 class="fw-bold mb-1 text-dark" th:text="${facilitiesCount}">0</h2><p class="text-muted small mb-0">Об'єктів інфраструктури</p></div>
                </div>
            </a>
        </div>
        <div class="col-md-3">
            <a href="/ui/emergencies" class="text-decoration-none">
                <div class="card-custom p-4 h-100 d-flex flex-column justify-content-between">
                    <div class="d-flex justify-content-between align-items-start mb-3">
                        <div class="text-danger fs-3"><i class="bi bi-exclamation-triangle-fill"></i></div>
                        <span class="badge bg-danger bg-opacity-10 text-danger rounded-pill">Увага</span>
                    </div>
                    <div><h2 class="fw-bold mb-1 text-dark" th:text="${emergenciesCount}">0</h2><p class="text-muted small mb-0">Активних інцидентів</p></div>
                </div>
            </a>
        </div>
        <div class="col-md-3">
            <a href="/ui/impacts" class="text-decoration-none">
                <div class="card-custom p-4 h-100 d-flex flex-column justify-content-between">
                    <div class="d-flex justify-content-between align-items-start mb-3">
                        <div class="text-info fs-3"><i class="bi bi-people-fill"></i></div>
                    </div>
                    <div><h2 class="fw-bold mb-1 text-dark">1,240</h2><p class="text-muted small mb-0">Евакуйованого населення</p></div>
                </div>
            </a>
        </div>
        <div class="col-md-3">
            <a href="/ui/costs" class="text-decoration-none">
                <div class="card-custom p-4 h-100 d-flex flex-column justify-content-between">
                    <div class="d-flex justify-content-between align-items-start mb-3">
                        <div class="text-success fs-3"><i class="bi bi-currency-dollar"></i></div>
                    </div>
                    <div><h2 class="fw-bold mb-1 text-dark">$450k</h2><p class="text-muted small mb-0">Витрати на ліквідацію</p></div>
                </div>
            </a>
        </div>
    </div>

    <div class="row g-4">
        <div class="col-md-8">
            <div class="card-custom p-4 h-100">
                <h5 class="fw-bold mb-4">Динаміка зареєстрованих інцидентів (останні 6 місяців)</h5>
                <div style="height: 350px;"><canvas id="incidentChart"></canvas></div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="vstack gap-3">

                <div class="card-custom p-4 bg-danger bg-opacity-10 d-flex align-items-center">
                    <i class="bi bi-radioactive fs-3 text-danger me-3"></i>
                    <div>
                        <p class="text-danger small mb-1 fw-bold">МАКСИМАЛЬНА ДОЗА</p>
                        <h4 class="fw-bold mb-0 text-danger">1.20 Зв</h4>
                    </div>
                </div>

                <div class="card-custom p-4 bg-success bg-opacity-10 d-flex align-items-center">
                    <i class="bi bi-cash-stack fs-3 text-success me-3"></i>
                    <div>
                        <p class="text-success small mb-1 fw-bold">ЗАГАЛЬНІ ВИТРАТИ</p>
                        <h4 class="fw-bold mb-0 text-success">₴ 1.28 млн</h4>
                    </div>
                </div>

                <div class="card-custom p-4 bg-warning bg-opacity-10 d-flex align-items-center">
                    <i class="bi bi-globe-americas fs-3 text-warning me-3"></i>
                    <div>
                        <p class="text-warning small mb-1 fw-bold">НАЙМАСШТАБНІША НС</p>
                        <h4 class="fw-bold mb-0 text-dark">Регіональна</h4>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const ctx = document.getElementById('incidentChart').getContext('2d');
        const primaryColor = 'rgb(13, 110, 253)';

        const data = {
            labels: ['Червень', 'Липень', 'Серпень', 'Вересень', 'Жовтень', 'Листопад', 'Грудень'],
            datasets: [{
                label: 'Кількість НС',
                data: [5, 7, 12, 9, 14, 15, 15],
                backgroundColor: 'rgba(13, 110, 253, 0.4)',
                borderColor: primaryColor,
                borderWidth: 3,
                tension: 0.4,
                pointRadius: 6,
                pointBackgroundColor: primaryColor
            }]
        };

        const config = {
            type: 'line',
            data: data,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        bodyFont: { size: 14 },
                        titleFont: { size: 16, weight: 'bold' }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: { color: '#eee' },
                        title: { display: true, text: 'Кількість інцидентів', color: '#555' }
                    },
                    x: {
                        grid: { display: false }
                    }
                }
            }
        };

        new Chart(ctx, config);
    });
</script>
</body>
</html>
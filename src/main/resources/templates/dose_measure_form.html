<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments :: head_styles}"></head>
<body>
<div th:replace="~{fragments :: sidebar('dose-measures')}"></div>
<div class="main-content">
  <h2 class="fw-bold mb-4" th:text="${isNew} ? 'Додати новий вимір дози' : 'Редагувати вимір дози #' + ${doseMeasure.id}">Форма дози</h2>
  <div class="card-custom p-4">
    <form th:action="@{/ui/dose-measures/save}" th:object="${doseMeasure}" method="post">
      <input type="hidden" th:field="*{id}" />

      <div class="mb-3">
        <label for="emergency" class="form-label fw-bold">Пов'язана аварія</label>
        <select id="emergency" class="form-select" th:field="*{emergency}" required>
          <option th:each="e : ${emergencies}"
                  th:value="${e.id}"
                  th:text="${'ID ' + e.id + ': ' + e.communalType + ' (' + #temporals.format(e.startDate, 'yyyy-MM-dd') + ')'}"
                  th:selected="${!isNew and doseMeasure.emergency != null and doseMeasure.emergency.id == e.id}">
          </option>
        </select>
      </div>

      <div class="mb-3">
        <label for="measurementDate" class="form-label fw-bold">Дата виміру</label>
        <input type="datetime-local" class="form-control" id="measurementDate" th:field="*{measurementDate}" required>
      </div>

      <div class="mb-4">
        <label for="doseValue" class="form-label fw-bold">Значення дози (Зіверт, Зв)</label>
        <input type="number" step="0.001" min="0" class="form-control" id="doseValue" th:field="*{doseValue}" required>
        <div class="form-text">Використовуйте крапку як десятковий роздільник. Мінімальне значення 0.</div>
      </div>

      <hr>
      <button type="submit" class="btn btn-success me-2"><i class="bi bi-save me-2"></i> Зберегти</button>
      <a href="/ui/dose-measures" class="btn btn-outline-secondary">Скасувати</a>
    </form>
  </div>
</div>
</body>
</html>